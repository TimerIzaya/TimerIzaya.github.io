---
layout:     post
title:      拿下事务
subtitle:   
date:       2021-11-19
author:     Timer
header-img: img/the-first.png
catalog: false
tags:
    - Mysql
    - 数据库

---

## 事务是什么

一组sql，要么全成功，要么全失败。

事务是在引擎层实现的，mysql是个支持多引擎的系统，但不是所有引擎都支持事务，比如经典的innodb支持，myisam不支持。  

##   

## 隔离与隔离级别

当多个事务执行时，免不了出现一堆问题。主要有脏读（dirty read）、幻读（phantom read）、不可重复读（non-repeatable read）。

隔离级别就是为了解决这些问题。隔离级别越安全，效率就越低，很多时候需要找一个平衡点。

隔离级别分为四种，安全性由低到高，效率由高到低。

1. 读未提交（read uncomitted）：事务A没提交，事务B就能看到A的修改内容
2. 读提交（read committed）：事务A提交完，事务B才能看到A的修改内容
3. 可重复度（repeatable read）：不管事务A怎么改，事务B从头到尾看到的内容都是一致的
4. 串行化（serializable）：所有读和写操作都会加锁

底层实现的话，数据库会创建一个视图，查询以视图为准。

1：不需要视图，直接返回最新值。

2：每次sql执行的时候创建一个视图。

3：事务开始的时候创建一个视图。

4：用锁解决，不需要视图。







