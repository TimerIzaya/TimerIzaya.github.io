---
layout:     post
title:      彻底拿下HashMap
subtitle:   复盘学习顶级JAVA大佬的思维
date:       2021-9-16
author:     Timer
header-img: img/the-first.png
catalog: false
tags:
    - JDK


---

## 一. HashMap在JDK中的结构层次

先来一张Java.Util包的类结构（可打开大图）

![](https://gitee.com/timerizaya/timer-pic/raw/master/img/Package%20util.png)

Util里主要容器类就是Collection和Map，先研究Map这一块，Map容器系列设计结构如下。

![](https://gitee.com/timerizaya/timer-pic/raw/master/img/20210916153537.png)

#### Map：Map接口设计好了所有Map基础操作的方法。

#### AbstractMap：

```
	This class provides a skeletal implementation of the Map interface, to minimize the effort required to     implement this interface.
	To implement an unmodifiable map, the programmer needs only to extend this class and provide an implementation for the entrySet method, which returns a set-view of the map's mappings.  
  	To implement a modifiable map, the programmer must additionally override this class's put method (which otherwise throws an UnsupportedOperationException)。
```

这个类提供了Map接口的基本实现，目的让我们实现这个类的时候少费点功夫。

AbstractMap仅有一个抽象方法：

![](https://gitee.com/timerizaya/timer-pic/raw/master/img/20210916162353.png)

要想实现一个不可修改的Map（视图Map），只需要继承这个类，实现这个方法，这样就可以返回这个map的视图了。

要想实现一个可修改的Map（正常使用的Map），就必须要实现这个类的put方法。因为AbstractMap默认自己是个视图Map。



**看源码看到这里，真的想吐槽，JDK里有的不可变Map，也就是Collections.UnmodifiableMap。只实现了Map接口，自己人都不用自己人的东西，离谱。又去看了一下源码的作者，这两个类都是一个人写的，自己都不用自己写的类，离大谱。**

```
 private static class UnmodifiableMap<K,V> implements Map<K,V>, Serializable {
 }
```

**所以到头来，Abstract的作用就只在于：实现了很多Map的基础方法，子类的其他Map，比如Hashmap、TreeMap等，可以选择性的覆盖。** 



























