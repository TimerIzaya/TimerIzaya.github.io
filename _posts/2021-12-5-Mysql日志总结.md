---
layout:     post
title:      Mysql日志总结
subtitle:   备份合理，万无一失
date:       2021-12-5
author:     Timer
header-img: img/the-first.png
catalog: false
tags:
    - Mysql
    - 数据库

---

## BinLog

官方文档：https://dev.mysql.com/doc/refman/8.0/en/binary-log.html

binlog是server层维护的一种二进制逻辑日志，说白了就是记sql语句的。

主要作用有：

- 主从复制：master开binlog，master把它的binlog给slave，用于slave和master同步数据。
- 数据恢复：通过mysqlbinlog工具恢复数据，比如归档需要。

**查看其位置信息**

```
show variables like '%log_bin%';
```

**查看binlog文件列表**

```
show binary logs;
```

**查看当前状态，正在写的文件和写的位置**

```
show master status
```

**查看文件内容**

```
mysqlbinlog [file]
```

##   

## BinLog 格式

```
show variables like 'binlog_format';
```

- Statememt level ：记录每一条修改数据的sql。**缺点是为了保障slave和master能同步，必须记录上下文信息，保证主从的一致性。**
- Row level ：仅仅保存被修改的部分。**缺点是以行的单位记录修改细节，因此内容会特别多，日志量很大。尤其当执行alter语句，整个表结构发生变化，那么每一条记录都会记录到日志，效率很低。**
- Mixed level：顾名思义。但是新版mysql对row也进行了优化，遇见表结构变更等非常冗余的部分会直接用statement来替代。





















