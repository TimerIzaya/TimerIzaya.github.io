---
layout:     post
title:      拿下TCP
subtitle:   重中之重
date:       2022-1-20
author:     Timer
header-img: img/the-first.png
catalog: false
tags:
    - 计算机网络

---

## 前言

钻牛角尖太容易一环套一环了，想做个IM去学Netty，学Netty要学IO多路复用，学IO多路复用得看epoll实现原理，学完IO多路复用再用Reactor实现的时候，又会碰到一堆网络问题，各种沾包、丢包层出不穷，tcp/ip这关是迟早要过了。



## 七层模型和四层模型

![img](https://gitee.com/timerizaya/timer-pic/raw/master/img/v2-2d62ba265be486cb94ab531912aa3b9c_720w.jpg)

首先，TCP在网络OSI的七层模型中的第四层——Transport层，IP在第三层——Network层，ARP在第二层——Data Link层，在第二层上的数据，我们叫Frame，在第三层上的数据叫Packet，第四层的数据叫Segment。



## TCP头的格式

![image-20220129222610428](https://gitee.com/timerizaya/timer-pic/raw/master/img/image-20220129222610428.png)

#### 需要注意的点是：

- **Sequence Number** ：用于解决包乱序问题
- **Acknowledgement Number**：就是ACK，用于确认收到，**用来解决丢包的问题**。
- **Window** ：又叫Advertised-Window**，也就是著名的滑动窗口（Sliding Window），**用于解决流控的。
- **TCP Flag** ：也就是包的类型，**主要是用于操控TCP的状态机的**。

#### 其他位置的信息如下：

![image-20220129225345516](https://gitee.com/timerizaya/timer-pic/raw/master/img/image-20220129225345516.png)





















